<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tufted Rug Pricing Calculator</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .container { background: white; border-radius: 15px; padding: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        h1, h2, h3 { color: #2c3e50; }
        .settings-section, .setup-section, .results-section, .breakdown-section, .code-section { margin-bottom: 30px; border-radius: 10px; padding: 20px; }
        .settings-section { background: #f0f4f8; border-left: 5px solid #e67e22; }
        .settings-section input { width: 100%; margin-bottom: 10px; padding: 8px; }
        .input-section { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .input-group { background: #fff; padding: 15px; border-radius: 8px; border: 2px solid #e9ecef; transition: border-color 0.3s; }
        .input-group:hover { border-color: #3498db; }
        label { display: block; margin-bottom: 5px; font-weight: 600; color: #34495e; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 16px; }
        .calculate-btn, .save-settings-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 10px 20px; border: none; border-radius: 25px; font-size: 16px; cursor: pointer; transition: transform 0.3s; display: inline-block; margin-top: 10px; }
        .calculate-btn:hover, .save-settings-btn:hover { transform: translateY(-2px); }
        .results-section { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white; }
        .results-grid, .breakdown-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .result-item, .breakdown-item { background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; backdrop-filter: blur(10px); }
        .final-price { background: rgba(255,255,255,0.3); padding: 20px; border-radius: 10px; text-align: center; margin-top: 20px; }
        @media (max-width: 768px) { .input-section, .results-grid, .breakdown-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <h1>üßµ Tufted Rug Pricing Calculator</h1>

        <!-- SETTINGS PANEL -->
        <div class="settings-section">
            <h2>‚öôÔ∏è Settings</h2>
            <label>Tuft Cloth (KSh/m¬≤): <input type="number" id="setting-tuftCloth" /></label>
            <label>Yarn (KSh/skein): <input type="number" id="setting-yarn" /></label>
            <label>Glue (KSh per sq ft): <input type="number" id="setting-glue" /></label>
            <label>Backing (KSh/m¬≤): <input type="number" id="setting-backing" /></label>
            <label>Miscellaneous (flat KSh): <input type="number" id="setting-misc" /></label>
            <label>Hourly Rate (KSh/hr): <input type="number" id="setting-hourlyRate" /></label>
            <button class="save-settings-btn" onclick="saveSettings()">Save Settings</button>
        </div>

        <!-- ORDER INPUTS -->
        <div class="input-section">
            <div class="input-group"><label>Rug Length (ft):</label><input id="length" type="number" value="3" min="1" step="0.5"></div>
            <div class="input-group"><label>Rug Width (ft):</label><input id="width" type="number" value="2" min="1" step="0.5"></div>
            <div class="input-group"><label>Complexity:</label><select id="complexity"><option value="simple">Simple</option><option value="medium" selected>Medium</option><option value="complex">Complex</option></select></div>
            <div class="input-group"><label>Pile Type:</label><select id="pileType"><option value="loop">Loop</option><option value="cut" selected>Cut</option></select></div>
            <div class="input-group"><label>Experience:</label><select id="experience"><option value="beginner">Beginner</option><option value="intermediate" selected>Intermediate</option><option value="advanced">Advanced</option></select></div>
            <div class="input-group"><label>Rush Order:</label><select id="rushOrder"><option value="no" selected>No</option><option value="yes">Yes</option></select></div>
        </div>
        <button class="calculate-btn" onclick="calculatePrice()">Calculate Price</button>

        <!-- RESULTS -->
        <div class="results-section" id="results" style="display:none;">
            <h2>üí∞ Price Breakdown</h2>
            <div class="results-grid">
                <div class="result-item"><div>Base Materials</div><div id="baseMaterials"></div></div>
                <div class="result-item"><div>With OH (40%)</div><div id="withOverhead"></div></div>
                <div class="result-item"><div>Labor Cost</div><div id="laborCost"></div></div>
                <div class="result-item"><div>Profit</div><div id="profit"></div></div>
            </div>
            <div class="final-price"><h3>FINAL PRICE</h3><div id="finalPrice" style="font-size:32px;"></div></div>
            <h3>üìä Detailed Breakdown</h3>
            <div class="breakdown-grid">
                <div class="breakdown-item">Size: <span id="rugSize"></span></div>
                <div class="breakdown-item">Tuft Cloth: <span id="tuftCloth"></span></div>
                <div class="breakdown-item">Yarn Cost: <span id="yarnCost"></span></div>
                <div class="breakdown-item">Glue Cost: <span id="glueCost"></span></div>
                <div class="breakdown-item">Backing Cost: <span id="backingCost"></span></div>
                <div class="breakdown-item">Est. Hours: <span id="estimatedHours"></span></div>
                <div class="breakdown-item">Rate: <span id="hourlyRateVal"></span></div>
            </div>
        </div>
    </div>

    <script>
        // DEFAULT SETTINGS
        const defaultSettings = { tuf                                                                                                                     tCloth:1000, yarn:100, glue:45, backing:400, misc:300, hourlyRate:375 };

        function loadSettings() {
            const s = JSON.parse(localStorage.getItem('pricingSettings')||'null') || defaultSettings;
            for (let key in s) document.getElementById(`setting-${key}`).value = s[key];
            return s;
        }
        function saveSettings() {
            const s = {};
            ['tuftCloth','yarn','glue','backing','misc','hourlyRate'].forEach(k => s[k]=parseFloat(document.getElementById(`setting-${k}`).value)||defaultSettings[k]);
            localStorage.setItem('pricingSettings',JSON.stringify(s));
            alert('Settings saved!');
        }

        function calculatePrice() {
            const length = parseFloat(document.getElementById('length').value);
            const width = parseFloat(document.getElementById('width').value);
            const complexity = document.getElementById('complexity').value;
            const pileType = document.getElementById('pileType').value;
            const experience = document.getElementById('experience').value;
            const rushOrder = document.getElementById('rushOrder').value;

            const rates = loadSettings();
            const timeEstimates = { simple:2.5, medium:4.5, complex:8 };
            const expMult = { beginner:1.5, intermediate:1.25, advanced:1 };
            const profitMargin = { simple:0.15, medium:0.2, complex:0.25 };

            const areaFt = length*width;
            const areaM2 = areaFt*0.092903;

            const tuftClothCost = areaM2 * rates.tuftCloth * 1.15;
            const yarnCov = pileType==='cut'?0.2:0.3;
            const yarnCost = (areaFt/yarnCov)*rates.yarn;
            const glueCost = areaFt*rates.glue;
            const backingCost = areaM2*rates.backing;
            const baseMat = tuftClothCost + yarnCost + glueCost + backingCost + rates.misc;

            const withOH = baseMat*1.4;
            const hrs = (timeEstimates[complexity]+2.5+0.5)*expMult[experience];
            const labor = hrs * rates.hourlyRate;
            const subtotal = withOH + labor;
            const profit = subtotal * profitMargin[complexity];
            const rushPremium = rushOrder==='yes'?subtotal*0.25:0;
            const final = subtotal+profit+rushPremium;

            // display
            document.getElementById('results').style.display='block';
            document.getElementById('baseMaterials').textContent=`KSh ${Math.round(baseMat).toLocaleString()}`;
            document.getElementById('withOverhead').textContent=`KSh ${Math.round(withOH).toLocaleString()}`;
            document.getElementById('laborCost').textContent=`KSh ${Math.round(labor).toLocaleString()}`;
            document.getElementById('profit').textContent=`KSh ${Math.round(profit).toLocaleString()}`;
            document.getElementById('finalPrice').textContent=`KSh ${Math.round(final).toLocaleString()}`;
            document.getElementById('rugSize').textContent=`${areaFt} sq ft (${areaM2.toFixed(2)} m¬≤)`;
            document.getElementById('tuftCloth').textContent=`KSh ${Math.round(tuftClothCost).toLocaleString()}`;
            document.getElementById('yarnCost').textContent=`KSh ${Math.round(yarnCost).toLocaleString()}`;
            document.getElementById('glueCost').textContent=`KSh ${Math.round(glueCost).toLocaleString()}`;
            document.getElementById('backingCost').textContent=`KSh ${Math.round(backingCost).toLocaleString()}`;
            document.getElementById('estimatedHours').textContent=`${hrs.toFixed(1)} hrs`;
            document.getElementById('hourlyRateVal').textContent=`KSh ${rates.hourlyRate}`;
        }

        // initialize inputs
        window.addEventListener('DOMContentLoaded', ()=> loadSettings());
    </script>
</body>
</html>
